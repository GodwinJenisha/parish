import{a as K,g as O,aG as V,s as $,h as k,_ as u,aW as Z,r as a,u as H,b as Q,j as t,c as eo,d as X,p as C,aX as to,aY as ro,aZ as ao,ac as so,aD as no,G as F,T as E,l as U,B as io,a_ as lo,N as co,a$ as go,C as uo,D as mo,aQ as ho,aR as po,v as w,an as xo,I as fo,m as vo,ai as Io}from"./main-8UzOKjJg.js";function ko(e){return K("MuiCircularProgress",e)}O("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const So=["className","color","disableShrink","size","style","thickness","value","variant"];let B=e=>e,G,T,z,N;const I=44,yo=V(G||(G=B`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Po=V(T||(T=B`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),bo=e=>{const{classes:o,variant:r,color:s,disableShrink:c}=e,l={root:["root",r,`color${k(s)}`],svg:["svg"],circle:["circle",`circle${k(r)}`,c&&"circleDisableShrink"]};return X(l,ko,o)},Lo=$("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.root,o[r.variant],o[`color${k(r.color)}`]]}})(({ownerState:e,theme:o})=>u({display:"inline-block"},e.variant==="determinate"&&{transition:o.transitions.create("transform")},e.color!=="inherit"&&{color:(o.vars||o).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&Z(z||(z=B`
      animation: ${0} 1.4s linear infinite;
    `),yo)),Co=$("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,o)=>o.svg})({display:"block"}),jo=$("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.circle,o[`circle${k(r.variant)}`],r.disableShrink&&o.circleDisableShrink]}})(({ownerState:e,theme:o})=>u({stroke:"currentColor"},e.variant==="determinate"&&{transition:o.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&Z(N||(N=B`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Po)),$o=a.forwardRef(function(o,r){const s=H({props:o,name:"MuiCircularProgress"}),{className:c,color:l="primary",disableShrink:S=!1,size:y=40,style:j,thickness:d=3.6,value:x=0,variant:P="indeterminate"}=s,b=Q(s,So),g=u({},s,{color:l,disableShrink:S,size:y,thickness:d,value:x,variant:P}),m=bo(g),f={},n={},L={};if(P==="determinate"){const h=2*Math.PI*((I-d)/2);f.strokeDasharray=h.toFixed(3),L["aria-valuenow"]=Math.round(x),f.strokeDashoffset=`${((100-x)/100*h).toFixed(3)}px`,n.transform="rotate(-90deg)"}return t.jsx(Lo,u({className:eo(m.root,c),style:u({width:y,height:y},n,j),ownerState:g,ref:r,role:"progressbar"},L,b,{children:t.jsx(Co,{className:m.svg,ownerState:g,viewBox:`${I/2} ${I/2} ${I} ${I}`,children:t.jsx(jo,{className:m.circle,style:f,ownerState:g,cx:I,cy:I,r:(I-d)/2,fill:"none",strokeWidth:d})})}))});function Ro(e){return K("MuiLoadingButton",e)}const p=O("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),Eo=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],Bo=e=>{const{loading:o,loadingPosition:r,classes:s}=e,c={root:["root",o&&"loading"],startIcon:[o&&`startIconLoading${k(r)}`],endIcon:[o&&`endIconLoading${k(r)}`],loadingIndicator:["loadingIndicator",o&&`loadingIndicator${k(r)}`]},l=X(c,Ro,s);return u({},s,l)},Mo=e=>e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"&&e!=="classes",Wo=$(C,{shouldForwardProp:e=>Mo(e)||e==="classes",name:"MuiLoadingButton",slot:"Root",overridesResolver:(e,o)=>[o.root,o.startIconLoadingStart&&{[`& .${p.startIconLoadingStart}`]:o.startIconLoadingStart},o.endIconLoadingEnd&&{[`& .${p.endIconLoadingEnd}`]:o.endIconLoadingEnd}]})(({ownerState:e,theme:o})=>u({[`& .${p.startIconLoadingStart}, & .${p.endIconLoadingEnd}`]:{transition:o.transitions.create(["opacity"],{duration:o.transitions.duration.short}),opacity:0}},e.loadingPosition==="center"&&{transition:o.transitions.create(["background-color","box-shadow","border-color"],{duration:o.transitions.duration.short}),[`&.${p.loading}`]:{color:"transparent"}},e.loadingPosition==="start"&&e.fullWidth&&{[`& .${p.startIconLoadingStart}, & .${p.endIconLoadingEnd}`]:{transition:o.transitions.create(["opacity"],{duration:o.transitions.duration.short}),opacity:0,marginRight:-8}},e.loadingPosition==="end"&&e.fullWidth&&{[`& .${p.startIconLoadingStart}, & .${p.endIconLoadingEnd}`]:{transition:o.transitions.create(["opacity"],{duration:o.transitions.duration.short}),opacity:0,marginLeft:-8}})),Do=$("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(e,o)=>{const{ownerState:r}=e;return[o.loadingIndicator,o[`loadingIndicator${k(r.loadingPosition)}`]]}})(({theme:e,ownerState:o})=>u({position:"absolute",visibility:"visible",display:"flex"},o.loadingPosition==="start"&&(o.variant==="outlined"||o.variant==="contained")&&{left:o.size==="small"?10:14},o.loadingPosition==="start"&&o.variant==="text"&&{left:6},o.loadingPosition==="center"&&{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled},o.loadingPosition==="end"&&(o.variant==="outlined"||o.variant==="contained")&&{right:o.size==="small"?10:14},o.loadingPosition==="end"&&o.variant==="text"&&{right:6},o.loadingPosition==="start"&&o.fullWidth&&{position:"relative",left:-10},o.loadingPosition==="end"&&o.fullWidth&&{position:"relative",right:-10})),Uo=a.forwardRef(function(o,r){const s=a.useContext(to),c=ro(s,o),l=H({props:c,name:"MuiLoadingButton"}),{children:S,disabled:y=!1,id:j,loading:d=!1,loadingIndicator:x,loadingPosition:P="center",variant:b="text"}=l,g=Q(l,Eo),m=ao(j),f=x??t.jsx($o,{"aria-labelledby":m,color:"inherit",size:16}),n=u({},l,{disabled:y,loading:d,loadingIndicator:f,loadingPosition:P,variant:b}),L=Bo(n),h=d?t.jsx(Do,{className:L.loadingIndicator,ownerState:n,children:f}):null;return t.jsxs(Wo,u({disabled:y||d,id:m,ref:r},g,{variant:b,classes:L,ownerState:n,children:[n.loadingPosition==="end"?S:h,n.loadingPosition==="end"?h:S]}))});function _o(){const e=so(),[o,r]=a.useState(!1),[s,c]=a.useState(""),[l,S]=a.useState(""),[y,j]=a.useState([]),[d,x]=a.useState(null),[P,b]=a.useState(!1),[g,m]=a.useState(null),[f,n]=a.useState(!1),[L,h]=a.useState(""),[M,W]=a.useState("success"),v=no();a.useEffect(()=>{F.get("http://localhost:8081/api/user/list").then(i=>{j(i.data)}).catch(i=>{console.error("Error fetching user data:",i)})},[]),a.useEffect(()=>{const i=localStorage.getItem("token"),R=localStorage.getItem("role");i&&R&&m(i)},[]);const Y=async()=>{b(!1);try{console.log("Attempting login with email:",s),console.log("Attempting login with password:",l);const i=await F.post("http://localhost:8081/api/user/login",{username:s,password:l});console.log("Login response:",i.data);const{token:R,role:D,username:_,permissions:A}=i.data;switch(console.log("Received token:",R),console.log("Received role:",D),console.log("Received username:",_),console.log("Received permissions:",A),localStorage.setItem("token",R),localStorage.setItem("role",D),localStorage.setItem("username",_),localStorage.setItem("permissions",A),console.log("Token stored in localStorage:",localStorage.getItem("token")),console.log("Role stored in localStorage:",localStorage.getItem("role")),console.log("username stored in localStorage:",localStorage.getItem("username")),console.log("permissions stored in localStorage:",localStorage.getItem("permissions")),D){case"Admin":v.push("/");break;case"Moderator":v.push("/");break;case"Accountant":v.push("/");break;case"User":v.push("/");break;default:break}c(""),S(""),W("success"),h("Login successful"),n(!0)}catch{console.error("Login Error:",d),x("Invalid email or password"),b(!0),W("error"),h("Invalid email or password"),n(!0)}},q=()=>{console.log("Logging out..."),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("username"),localStorage.removeItem("permissions"),console.log("Token removed from localStorage:",localStorage.getItem("token")),console.log("Role removed from localStorage:",localStorage.getItem("role")),console.log("Role removed from localStorage:",localStorage.getItem("username")),console.log("Role removed from localStorage:",localStorage.getItem("permissions")),m(null),W("success"),h("Logout successful"),n(!0)},J=t.jsx(t.Fragment,{children:!g&&t.jsxs(t.Fragment,{children:[t.jsxs(U,{spacing:3,padding:3,children:[t.jsx(w,{name:"email",label:"Username",value:s,onChange:i=>c(i.target.value),error:P,sx:{marginBottom:"16px"}}),t.jsx(w,{name:"password",label:"Password",type:o?"text":"password",InputProps:{endAdornment:t.jsx(xo,{position:"end",children:t.jsx(fo,{onClick:()=>r(!o),edge:"end",children:t.jsx(vo,{icon:o?"eva:eye-fill":"eva:eye-off-fill"})})})},value:l,onChange:i=>S(i.target.value),error:P})]}),t.jsx(Uo,{fullWidth:!0,size:"large",variant:"contained",color:"inherit",onClick:Y,children:"Login"})]})}),oo=t.jsxs(t.Fragment,{children:[t.jsxs(E,{variant:"h6",align:"center",sx:{mb:2},children:["Logged in as: ",g]}),t.jsxs(E,{variant:"body1",align:"center",sx:{mb:2},children:["Role: ",localStorage.getItem("role")]}),t.jsxs(U,{spacing:2,sx:{width:"100%"},children:[localStorage.getItem("role")==="Admin"&&t.jsx(C,{onClick:()=>v.push("/"),variant:"contained",color:"primary",fullWidth:!0,children:"Go to Dashboard"}),localStorage.getItem("role")==="Moderator"&&t.jsx(C,{onClick:()=>v.push("/parish"),variant:"contained",color:"primary",fullWidth:!0,children:"Go to Parish"}),localStorage.getItem("role")==="Accountant"&&t.jsx(C,{onClick:()=>v.push("/products"),variant:"contained",color:"primary",fullWidth:!0,children:"Go to Products"}),localStorage.getItem("role")==="User"&&t.jsx(C,{onClick:()=>v.push("/member"),variant:"contained",color:"primary",fullWidth:!0,children:"Go to Member"})]}),t.jsx(C,{onClick:q,variant:"outlined",color:"error",fullWidth:!0,sx:{mt:2},children:"Logout"})]});return t.jsxs(io,{sx:{...lo({color:co(e.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[t.jsx(go,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),t.jsx(U,{alignItems:"center",justifyContent:"center",sx:{height:1},children:t.jsxs(uo,{sx:{p:5,width:1,maxWidth:420},children:[t.jsx(E,{variant:"h4",style:{textAlign:"center"},children:"Sign in to STCK"}),t.jsx(mo,{sx:{my:3},children:t.jsx(E,{variant:"body2",sx:{color:"text.secondary"},children:"Enter your Credentials"})}),g?oo:J,t.jsx(ho,{open:f,autoHideDuration:M==="error"?null:5e3,onClose:()=>{M!=="error"&&n(!1)},children:t.jsx(po,{elevation:6,variant:"filled",onClose:()=>n(!1),severity:M,children:L})})]})})]})}function Fo(){return t.jsxs(t.Fragment,{children:[t.jsx(Io,{children:t.jsx("title",{children:" STCK | ParishPro | Login "})}),t.jsx(_o,{})]})}export{Fo as default};
